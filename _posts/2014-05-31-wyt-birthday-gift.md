---
layout: post
keywords: blog
description: blog
title: "《加冕以回忆之冠》——从吴雨桐的生日礼物里我学到了些什么"
categories: [桌面.net]
tags: [Archive]
group: archive
icon: file-o
---


就在儿童节前夕，由于之前给吴雨桐准备的礼物实在是不合时宜送不出手，所以临时想到到淘宝出一本书，内容就是我跟吴童鞋一年多以来互发的2000多条短信。目前我还没有收到实体书，但是从设计上来说，我觉得我应该已经很满足了。中间的历程还是有很多可圈可点的地方，特地写下来留作纪念。
<h2>Open XML SDK</h2>
如果我可以成为这一本书之父的话，那么这个技术就可以说是这本书之母了。<del>难道你能指望吴雨桐同学成为这本书之母吗？哈哈哈</del> 因为没有这一个技术，2000多条短信的排版，至少花掉我一周的工作时间，倒不是我不愿意花掉这一周时间来准备这样一个有心的礼物。<del>哈哈，开玩笑的，傻子才会用一周来做这个事情呢！</del> 主要是因为2000多条短信的排版枯燥无味，很可能把我逼疯。这时候就需要open xml sdk登场了。 <br />
open xml sdk这个技术使得我可以简便地通过c#语言操作office文档，前提是他们必须是office 2007以上文档。不过在这个实例中，原文件是excel，我并没有用这个sdk处理，而是用已经驾轻就熟的数据库访问方式读取的数据。但是写入docx就比较麻烦了。不得不用到这个工具。 <br />
其实摸索的时候有点找不到头绪。但是很快就发现诀窍了。首先我需要在word里面作好最初的排版。然后利用下载包中提供的 open xml sdk tool打开这个文档，对于每一行都reflect一个方法，这个方法即是生成这一行格式的c#代码。动态生成内容之后，再append上文档就行。主要问题是我当初没有明白new run和new paragraph的区别，paragraph两行之间总有空行，闹腾了一阵子。当然这样排版之后，还是有很多细节由我亲自调整，毕竟要表现用心嘛！
源代码已经在我的github中给出，应该是一个叫做docxcreater的压缩包。 <br />

![shishi](wyt_book.jpg)
<br />
后来我收到了实体书了，这下子来补个图～怎么样，漂亮吧！ <br />
<img src="wyt_book2.jpg" />
<img src="wyt_book3.jpg" />

<h2>那些序言里没说的软话</h2>
为了显得正经，再加上当时成就感非常的大，所以写的心怀天下。既然这个博客没什么人看，我就把真真想要说的在这里说了吧。<del>其实最大的遗憾就是没有勇气把这个东西命名为《南与北》吧～</del><br />
<del> hidden codes </del>
